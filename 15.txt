a)
CREATE PROCEDURE `kursori`(
IN op VARCHAR(45)
)
BEGIN
/*Paikalliset muuttujat*/
DECLARE arvos INT;
DECLARE ID INT;
/*Tosi, kun kursori menee taulun loppuun*/
DECLARE done BOOLEAN;
/*Haetaan kursoriin kaikki tiedot kahdesta sarakkeesta*/
DECLARE arvos_cursor CURSOR for
SELECT idArviointi,Arvosana FROM Arviointi;
/* NOT FOUND-käsittelijä (kun rivit loppuu) */
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done=TRUE;
/*Avataan kursori*/
OPEN arvos_cursor;
/*Aloitetaan silmukka*/
arvos_loop: loop
/*Sijoitetaan kursorin arvot rivi kerrallaan muuttujiin*/
FETCH arvos_cursor INTO ID,arvos;
/*Kun kaikki luettu, silmukasta ulos*/
IF done then
CLOSE arvos_cursor;
LEAVE arvos_loop;
END IF;
/*Päivitetään Arvosana-sarakkeen yksi rivi*/
CASE op
	WHEN '+' THEN
		UPDATE Arviointi SET Arvosana=arvos+1 WHERE ID=idArviointi AND Arvosana < 5;
	WHEN '-' THEN
		UPDATE Arviointi SET Arvosana=arvos-1 WHERE ID=idArviointi AND Arvosana > 0;
	ELSE
		SELECT 'Invalid operation only + and -';
		SET done=TRUE;
END CASE;
END LOOP arvos_loop;
END

b)
CREATE PROCEDURE `UusiTunnus`()
BEGIN
DECLARE tunnus VARCHAR(45);
DECLARE ID INT;
DECLARE done BOOLEAN;
DECLARE tunnus_cursor CURSOR for
SELECT idOpiskelija,Luokkatunnus FROM Opiskelija;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done=TRUE;
OPEN tunnus_cursor;
tunnus_loop: loop
FETCH tunnus_cursor INTO ID,tunnus;
IF done then
CLOSE tunnus_cursor;
LEAVE tunnus_loop;
END IF;
IF tunnus='TVT25SPL' THEN
	UPDATE Opiskelija SET Luokkatunnus='TVT25SP' WHERE ID=idOpiskelija;
END IF;
END LOOP tunnus_loop;
END